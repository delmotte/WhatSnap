<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../components/customer-item.html"/>

<dom-module id="hello-world">
    <style>
        :host {
            display: block;
            box-sizing: border-box;
        }

        .author img {
            float: left;
            margin-right: 5px;
            max-height: 100px;
            max-width: 100px;
        }
    </style>

    <template>
        <h1>&lt;hello-world&gt;</h1>
        <content></content>
        <p class="author">
            <img src="{{author.image}}">
            Cheers,<br/>
            <span class="name">{{author.name}}</span>
        </p>
        <br/>
        <template is="dom-repeat" items="{{ customers }}">
            <customer-item customer='{{item}}'></customer-item>
        </template>
        <button on-click="helloComponents">Incremente Local Ids</button>
    </template>

</dom-module>

<script>
    Polymer({
        is: 'hello-world',

        properties: {
            fancy: Boolean,
            author: {
                type: Object,
                value: function() {
                    return {
                        name:  'Dimitri Glazkov',
                        image: 'http://addyosmani.com/blog/wp-content/uploads/2013/04/unicorn.jpg'
                    };
                }
            },
            customers: {
                type: Array,
                value: function () {
                    return [];
                }
            }
        },


        ready: function () {
            console.log('hello-world is ready !');
            this.set('customers', Model.customers);
        },

        attached: function () {
            // add this element to the communication bus
            this.id = Bus.register({
                receive: function (eventname, data) {
                    if (eventname === 'hello') {
                        console.log('HELLO Response');
                    }
                }
            });
        },

        detached: function () {
            // remove this element from the communication bus
            Bus.destroy({id:this.id});
        },

        helloComponents: function (event, nbClick) {
            Bus.emit('incr', nbClick);
            Bus.emit('hello', 'helloworld');
        }

    });
</script>